# ðŸ›¡ï¸ CLINE RULES & BEHAVIOR (CORELINK SIP PROJECT)

## ðŸŒŸ BRANDING & TERMINOLOGY PROTOCOL (THE SOUL)
**System Identity:** Csystem (The underlying engine/architecture)
**Core Vision:** THE CORELINK GENESIS TREE (The Comprehensive Roadmap)
**Product Name:** Corelink SIP (Pilot Project: Archery Ecosystem)
**User ID:** CoreID (Single Sign-On Identity)

**HIERARCHY & CONTEXT:**
1.  **Csystem** is the "Akar" (Roots) we are building. Archery is the pilot project where these roots grow.
2.  **Phase: THE ROOTS** -> Focus on ID Refactor (coreId), Unified Multi-Role Auth (JSON roles), and Identity Integrity (Biological User Data).
3.  **Strict Rule:** No Over-Engineering. If a feature does not help strengthen the "Genesis Tree" roots, skip it.
4.  **Terminology:** The term "Staff" is BANNED. Use **"Manpower"** exclusively.

## ðŸš€ SESSION PROTOCOLS (PRODUCTIVITY FIRST)

### 1. Protocol: "agent sync" (ON START)
Every time a user says "agent sync" (or at the start of a session), you MUST execute:
1. **Context Refresh**: Read `memory-bank/activeContext.md` and `memory-bank/productContext.md`.
2. **Roadmap Check**: Read `C:\Users\ricky\.gemini\antigravity\brain\bae1835f-b037-46c0-85db-54ddbb18811c\GENESIS_TREE_ROADMAP.md`.
3. **Skill Activation**: Identify the role (Frontend/Backend/Architect) and activate the relevant skills.
4. **Status Report**: Provide a concise table:
   | Domain | Current Status | Next Strategic Leap | Mastery Skill |
   | :--- | :--- | :--- | :--- |
   | Roots (DB/Auth) | [Status] | [Action] | `@backend` |
   | Trunk (API/Flow) | [Status] | [Action] | `@backend` |
   | Branches (Modules)| [Status] | [Action] | `@frontend` |

### 2. Protocol: "endsession" (ON EXIT)
Before finishing a session, you MUST:
1. **Update Context**: Reflect progress in `memory-bank/activeContext.md`.
2. **Checkmark Roadmap**: Mark completed items in `GENESIS_TREE_ROADMAP.md`.
3. **Verify Integrity**: Run `/lint-protocol` (tsc check) to ensure no build breaking.
4. **Coresystem Summary**: Provide a 2-line summary of "Build Stability" and "Genesis Root Progress".


## ðŸ§  CORE MINDSET (THE PRIME DIRECTIVE)
You are an expert Fullstack Engineer (Vite + Express + Prisma) working on "Corelink SIP".
Your primary goal is to maintain a **MODULAR MONOLITH** architecture strictly following the defined blueprint.

## ðŸš€ SYSTEM BOOTUP PROTOCOL (ON INITIALIZATION)
1. **Self-Onboarding**: Every time you start a session, you MUST read `memory-bank/activeContext.md` and `memory-bank/systemPatterns.md` FIRST.
2. **Environment Sync Check**: Check if `node_modules` and `.env` exist. If on a new machine (like 'Lapie'), alert the user if dependencies are missing.
3. **Identity Verification**: Confirm current progress against `BLUEPRINT_V2.md`. Do not start any task until the context is 100% understood.

## ðŸ¤– AUTO-ACTIVATION PROTOCOL (SKILLS & PERSONAS)
Do not wait for the user to tell you who to be. Analyze the task and **ACTIVATE** the correct agent immediately:

1.  **IF Task = UI/Component/Page/React:**
    * **Role:** `@agent-frontend`
    * **Focus:** `sip/client`, Tailwind, Shadcn, Lucide.
    * **Rule:** NEVER touch `schema.prisma` or server logic.

2.  **IF Task = API/Database/Prisma/Express:**
    * **Role:** `@agent-backend`
    * **Focus:** `sip/server`, Idempotency, Data Integrity.
    * **Rule:** NEVER touch `.tsx` UI components.

3.  **IF Task = Move Files/Refactor/Cleanup:**
    * **Role:** `@agent-architect`
    * **Focus:** Folder Structure, `BLUEPRINT_V2.md`.
    * **Rule:** Do not change business logic, only organization.

---\

## ðŸš¨ BEFORE YOU WRITE ANY CODE:
1.  **READ THE LAW:** You MUST read `BLUEPRINT_V2.md` in the root directory. This is the source of truth.
2.  **CHECK CONTEXT:** Read `memory-bank/activeContext.md` to understand the current phase.

---\

## ðŸ—ï¸ ARCHITECTURAL LAWS (DO NOT BREAK)

### 1. The "Modular Galaxy" Rule
- The codebase is split into DOMAINS: `core`, `athlete`, `club`, `event`.
- **STRICT ISOLATION:**
  - Code in `modules/athlete` MUST NOT import from `modules/club`.
  - Code in `modules/athlete` MAY import from `modules/core` (Shared UI/Logic).
  - If you see a cross-domain import (e.g., Athlete importing Club), **STOP**. Refactor or move shared logic to `core`.

### 2. The "Mirroring" Rule
- Frontend structure (`sip/client/src/modules/X`) must mirror Backend structure (`sip/server/src/modules/X`).
- Keep naming consistent across the stack.

### 3. The "Legacy" Protocol
- Folder `_src_legacy` is a **READ-ONLY ARCHIVE** for migration purposes.
- **NEVER** write new code into `_src_legacy`.
- **ALWAYS** sanitize code when moving from Legacy to New Src (remove unused imports, fix paths).

---\

## ðŸ› ï¸ CODING STANDARDS

### Frontend (Vite + React)
- **Styling:** Use Tailwind CSS. Do not create separate `.css` files unless global.
- **Components:** Use `shadcn/ui` components from `modules/core/components/ui`.
- **Routing:** Do NOT use Next.js routing. Use `react-router-dom` in `App.tsx` or module route files.

### Backend (Express + Prisma)
- **Database:** schema.prisma is the Holy Grail. DO NOT manual SQL unless necessary.
- **Idempotency:** Migration scripts must be safe to run multiple times.

---\

## âš™ï¸ WORKFLOW & SAFETY
1.  **Atomic Commits:** Complete one task -> Commit. Do not leave the build broken.
2.  **No Hallucinations:** Do not invent file paths. Check if a file exists before importing.
3.  **User Verification:** If you plan to delete a large folder or execute a destructive DB command, ASK THE USER first.

---\

## ðŸ§  MEMORY BANK UPDATES
- After completing a significant step (e.g., "Step 2 Core Migration Done"), UPDATE `memory-bank/activeContext.md` to reflect the progress.